#!/bin/bash

BIN="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
source $BIN/common-defs.sh

find $papers -type f -name "*.pstotext.xml" -printf "%p -> %p.meta.xml\n" > $workdir/all-files-meta

cd $workdir

split -a 4 -d -l 100 all-files-meta run-meta-

for f in run-meta-*
do
  cat <<EOF > "$f-sge"
#!/bin/bash

# --- interpreter
#$ -S /bin/sh
#
# --- run from current dir
#$ -cwd
#
# --- job name
#$ -N rexa.metatag
#
# --- stdio redirection
#$ -e /dev/null
#$ -o /dev/null
#
# --- merge stdout/stderr?
#$ -j y
#
# --- pass on entire env
#$ -V
#


declare -r metatagger="../the-world/the-livingroom/rexa1-metatagger/bin/runcrf"


EOF

  echo "cat $f | ../the-world/the-livingroom/rexa1-metatagger/bin/runcrf" >> "$f-sge"

done
